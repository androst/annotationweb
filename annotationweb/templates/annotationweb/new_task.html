{% extends 'annotationweb/one_column_layout.html' %}

{% block javascript %}
// This script refresh page when it gets focus back after lost it
var refresh = false;
$(window).focus(function() {
    if(refresh) {
        location.reload();
    }
    refresh = false;
});
$(window).blur(function() {
    refresh = true;
});
{% endblock %}


{% block content %}
<h2>New task</h2>

<form action="{% url 'new_task' %}" method="post">
    {% csrf_token %}
    <table>
        {{ form.as_table }}
    </table>
    <input type="submit" value="Submit" />
</form>

<script>
    function set_classification_type_enabled() {
        let classification_type_input = $("#id_classification_type");
        classification_type_input.prop('disabled', false);

        // Format label
        let label = $('label[for="' + classification_type_input.selector.slice(1) + '"]')[0];
        label.style.color = "#000000";
    }

    function set_classification_type_disabled() {
        let classification_type_input = $("#id_classification_type");
        classification_type_input.prop('disabled', true);
        // Format label
        let label = $('label[for="' + classification_type_input.selector.slice(1) + '"]')[0];
        label.style.color = "#aaaaaa";
    }

    $(document).ready(function(e) {
        set_classification_type_disabled();
    })

    $("#id_type").change(function () {
        let taskType = $(this).val();  // get the selected task type from the HTML input
        if (taskType === 'classification') {
            set_classification_type_enabled();
        } else {
            // Reset classification_type choice to default value
            $('select[name="classification_type"] option').attr("selected", false);
            $('select[name="classification_type"] option[value=""]').attr("selected", true);
            set_classification_type_disabled();
        }
    });
</script>

{% endblock %}
